(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{274:function(t,e,r){"use strict";r.r(e);var v=r(14),_=Object(v.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"http-proxy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-proxy"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://github.com/nodejitsu/node-http-proxy",target:"_blank",rel:"noopener noreferrer"}},[t._v("http-proxy"),e("OutboundLink")],1)]),t._v(" "),e("blockquote",[e("p",[t._v("代理请求")])]),t._v(" "),e("h2",{attrs:{id:"技巧"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#技巧"}},[t._v("#")]),t._v(" 技巧？")]),t._v(" "),e("ul",[e("li",[t._v("继承构造函数："),e("code",[t._v("function Child () { Parent.call(this) }")])]),t._v(" "),e("li",[t._v("闭包/柯里化："),e("code",[t._v("function A (type) { return function B (option) { return function C (...args) {} } }")])])]),t._v(" "),e("h2",{attrs:{id:"设计"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设计"}},[t._v("#")]),t._v(" 设计")]),t._v(" "),e("ul",[e("li",[t._v("请求的一步步处理函数化，保证函数名唯一，定义在一个对象上，再转成数组依次处理\n"),e("ul",[e("li",[t._v("属性拷贝为数组："),e("code",[t._v("Object.keys(a).map((k) =>a[k])")])])])]),t._v(" "),e("li",[t._v("hook请求的过程，继承eventemitter3\n"),e("ul",[e("li",[t._v("http/https\n"),e("ul",[e("li",[t._v("start")]),t._v(" "),e("li",[t._v("proxyReq")]),t._v(" "),e("li",[t._v("econnreset")]),t._v(" "),e("li",[t._v("error")]),t._v(" "),e("li",[t._v("proxyRes")]),t._v(" "),e("li",[t._v("end")])])]),t._v(" "),e("li",[t._v("wx\n"),e("ul",[e("li",[t._v("open")]),t._v(" "),e("li",[t._v("proxyReqWs")]),t._v(" "),e("li",[t._v("proxySocket")]),t._v(" "),e("li",[t._v("error")]),t._v(" "),e("li",[t._v("close")])])])])])]),t._v(" "),e("h2",{attrs:{id:"请求处理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#请求处理"}},[t._v("#")]),t._v(" 请求处理")]),t._v(" "),e("blockquote",[e("p",[t._v("前提：配置了 target 或 forward")])]),t._v(" "),e("ul",[e("li",[t._v("Sets "),e("code",[t._v("content-length")]),t._v(" to '0' if request is of DELETE type.")]),t._v(" "),e("li",[t._v("Sets timeout in request socket if it was specified in options.")]),t._v(" "),e("li",[t._v("Sets "),e("code",[t._v("x-forwarded-*")]),t._v(" headers if specified in config.")]),t._v(" "),e("li",[t._v("创建 "),e("code",[t._v("http/https.request")]),t._v("，并把请求的结构返回给原请求的 "),e("code",[t._v("response")]),t._v(".")])])])}),[],!1,null,null,null);e.default=_.exports}}]);